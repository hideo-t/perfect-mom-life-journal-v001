<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å®Œç’§ãƒãƒã®æ—¥ã€…å¥®é—˜è¨˜</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Zen+Kaku+Gothic+New:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg-primary: #0a0a0f;
      --bg-secondary: #12121a;
      --bg-card: #1a1a2e;
      --text-primary: #e0ddd5;
      --text-secondary: #8a8a9a;
      --accent: #4a9eff;
      --accent-dim: #2a5a9a;
      --gold: #c4a35a;
      --chapter-border: #2a2a3e;
      --serif: 'Noto Serif JP', 'Hiragino Mincho ProN', serif;
      --sans: 'Zen Kaku Gothic New', 'Hiragino Kaku Gothic ProN', sans-serif;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      background: var(--bg-primary);
      color: var(--text-primary);
      font-family: var(--serif);
      font-size: 17px;
      line-height: 1.95;
      min-height: 100vh;
    }

    /* â”€â”€â”€ Header â”€â”€â”€ */
    .hero {
      position: relative;
      text-align: center;
      padding: 100px 20px 80px;
      background: linear-gradient(180deg, #1a2a4a 0%, #0f1a2f 100%);
      overflow: hidden;
    }
    .hero::before {
      content: '';
      position: absolute; inset: 0;
      background: radial-gradient(ellipse at 50% 30%, rgba(120,180,255,0.15) 0%, transparent 70%);
    }
    .hero-title {
      font-family: var(--serif);
      font-size: clamp(1.8rem, 5vw, 3.2rem);
      font-weight: 700;
      letter-spacing: 0.08em;
      color: #ffffff;
      text-shadow: 0 2px 20px rgba(100,160,255,0.3);
      margin-bottom: 12px;
      position: relative;
    }
    .hero-sub {
      font-family: var(--sans);
      font-size: 0.9rem;
      color: #b0c4de;
      letter-spacing: 0.15em;
    }
    .hero-line {
      width: 60px; height: 1px;
      background: var(--gold);
      margin: 28px auto 0;
    }

    /* â”€â”€â”€ Navigation â”€â”€â”€ */
    .nav-bar {
      position: sticky; top: 0; z-index: 100;
      background: rgba(10,10,15,0.92);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--chapter-border);
      padding: 10px 20px;
      display: flex;
      align-items: center;
      gap: 16px;
      overflow-x: auto;
      font-family: var(--sans);
      font-size: 0.8rem;
    }
    .nav-bar .nav-title {
      color: var(--gold);
      font-weight: 700;
      white-space: nowrap;
      margin-right: 8px;
    }
    .nav-bar a {
      color: var(--text-secondary);
      text-decoration: none;
      white-space: nowrap;
      padding: 4px 10px;
      border-radius: 4px;
      transition: all 0.2s;
    }
    .nav-bar a:hover {
      color: var(--accent);
      background: rgba(74,158,255,0.1);
    }

    /* â”€â”€â”€ TOC â”€â”€â”€ */
    .toc {
      max-width: 700px;
      margin: 60px auto 40px;
      padding: 0 20px;
    }
    .toc h3 {
      font-family: var(--sans);
      font-size: 0.75rem;
      letter-spacing: 0.2em;
      color: var(--text-secondary);
      text-transform: uppercase;
      margin-bottom: 20px;
    }
    .toc-item {
      display: flex; align-items: center; gap: 16px;
      padding: 14px 18px;
      color: var(--text-primary);
      text-decoration: none;
      border-left: 2px solid var(--chapter-border);
      transition: all 0.25s;
      font-family: var(--sans);
      font-size: 0.95rem;
    }
    .toc-item:hover {
      border-color: var(--accent);
      background: rgba(74,158,255,0.04);
      padding-left: 24px;
    }
    .toc-num {
      font-size: 0.75rem;
      color: var(--accent-dim);
      font-weight: 700;
      min-width: 20px;
    }

    /* â”€â”€â”€ Characters â”€â”€â”€ */
    .characters {
      max-width: 700px;
      margin: 40px auto 60px;
      padding: 0 20px;
    }
    .characters h3 {
      font-family: var(--sans);
      font-size: 0.75rem;
      letter-spacing: 0.2em;
      color: var(--text-secondary);
      margin-bottom: 20px;
    }
    .char-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 14px;
    }
    .char-card {
      background: var(--bg-card);
      border: 1px solid var(--chapter-border);
      border-radius: 8px;
      padding: 18px;
    }
    .char-name {
      font-family: var(--sans);
      font-weight: 700;
      font-size: 1rem;
      color: var(--gold);
      margin-bottom: 4px;
    }
    .char-role {
      font-family: var(--sans);
      font-size: 0.75rem;
      color: var(--accent);
      margin-bottom: 8px;
    }
    .char-desc {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    /* â”€â”€â”€ Divider â”€â”€â”€ */
    .section-divider {
      width: 40px; height: 1px;
      background: var(--chapter-border);
      margin: 0 auto;
    }

    /* â”€â”€â”€ Chapter â”€â”€â”€ */
    .chapter {
      max-width: 700px;
      margin: 0 auto;
      padding: 80px 20px;
      border-top: 1px solid var(--chapter-border);
    }
    .chapter-header {
      text-align: center;
      margin-bottom: 48px;
    }
    .chapter-number {
      font-family: var(--sans);
      font-size: 0.7rem;
      letter-spacing: 0.25em;
      color: var(--accent-dim);
      display: block;
      margin-bottom: 8px;
    }
    .chapter-title {
      font-family: var(--serif);
      font-size: clamp(1.3rem, 3vw, 1.8rem);
      font-weight: 700;
      letter-spacing: 0.05em;
    }
    .chapter-image {
      margin: 0 -20px 40px;
      border-radius: 6px;
      overflow: hidden;
      border: 1px solid var(--chapter-border);
    }
    .chapter-image img {
      width: 100%;
      height: auto;
      display: block;
      opacity: 0.92;
    }
    .chapter-body p {
      margin-bottom: 1.2em;
      text-indent: 1em;
      text-align: justify;
    }
    .chapter-body p:empty {
      display: none;
    }

    /* â”€â”€â”€ Footer â”€â”€â”€ */
    .footer {
      text-align: center;
      padding: 60px 20px;
      font-family: var(--sans);
      font-size: 0.75rem;
      color: var(--text-secondary);
      border-top: 1px solid var(--chapter-border);
    }

    /* â”€â”€â”€ Reading mode toggle â”€â”€â”€ */
    .mode-toggle {
      position: fixed; bottom: 20px; right: 20px; z-index: 200;
      background: var(--bg-card);
      border: 1px solid var(--chapter-border);
      color: var(--text-secondary);
      font-family: var(--sans);
      font-size: 0.75rem;
      padding: 8px 14px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .mode-toggle:hover {
      border-color: var(--accent);
      color: var(--accent);
    }


    /* --- TTS Read Aloud --- */
    .tts-fab {
      position: fixed; bottom: 80px; right: 20px; z-index: 200;
      width: 48px; height: 48px; border-radius: 50%;
      background: var(--accent); color: #fff; border: none;
      font-size: 22px; cursor: pointer;
      box-shadow: 0 4px 16px rgba(0,0,0,0.4);
      transition: all 0.3s;
      display: flex; align-items: center; justify-content: center;
    }
    .tts-fab:hover { transform: scale(1.1); }
    .tts-fab.speaking { background: #e74c3c; animation: tts-pulse 1.5s infinite; }
    @keyframes tts-pulse {
      0%,100% { box-shadow: 0 4px 16px rgba(231,76,60,0.4); }
      50% { box-shadow: 0 4px 24px rgba(231,76,60,0.7); }
    }
    .tts-bar {
      position: fixed; bottom: 0; left: 0; right: 0; z-index: 200;
      background: rgba(20,20,30,0.95); backdrop-filter: blur(12px);
      border-top: 1px solid var(--chapter-border);
      padding: 10px 16px; display: none;
      align-items: center; gap: 10px;
      font-family: var(--sans); font-size: 0.85rem;
    }
    .tts-bar.active { display: flex; flex-wrap: wrap; }
    .tts-bar button {
      background: none; border: 1px solid var(--text-secondary);
      color: var(--text-primary); border-radius: 6px;
      padding: 6px 12px; cursor: pointer; font-size: 0.8rem;
      white-space: nowrap; transition: all 0.2s;
    }
    .tts-bar button:hover { border-color: var(--accent); color: var(--accent); }
    .tts-bar .tts-info {
      flex: 1; color: var(--text-secondary);
      overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
      min-width: 80px;
    }
    .tts-bar .tts-speed {
      display: flex; align-items: center; gap: 4px;
      color: var(--text-secondary); font-size: 0.75rem;
    }
    .tts-bar .tts-speed input { width: 60px; accent-color: var(--accent); }
    body.light .tts-bar {
      background: rgba(245,245,240,0.95); border-top-color: #ddd;
    }
    body.light .tts-bar button { border-color: #999; color: #333; }
    body.light .tts-bar .tts-info { color: #666; }

    /* â”€â”€â”€ Light mode â”€â”€â”€ */
    body.light {
      --bg-primary: #f5f0e8;
      --bg-secondary: #ebe5d9;
      --bg-card: #fff;
      --text-primary: #2a2a2a;
      --text-secondary: #6a6a6a;
      --chapter-border: #d5cfc3;
      --accent: #2563eb;
      --accent-dim: #6b9eff;
      --gold: #8a6d2b;
    }

    /* â”€â”€â”€ Responsive â”€â”€â”€ */
    @media (max-width: 600px) {
      body { font-size: 15px; }
      .chapter { padding: 50px 16px; }
    }

    /* â”€â”€â”€ Scroll progress â”€â”€â”€ */
    .scroll-progress {
      position: fixed; top: 0; left: 0; z-index: 200;
      height: 2px;
      background: linear-gradient(90deg, var(--accent), var(--gold));
      width: 0%;
      transition: width 0.1s;
    }
  </style>
</head>
<body>
  <div class="scroll-progress" id="progress"></div>

  <header class="hero">
    <h1 class="hero-title">å®Œç’§ãƒãƒã®æ—¥ã€…å¥®é—˜è¨˜</h1>
    <p class="hero-sub">GENERATED WITH LOCAL AI â€” OLLAMA + STABLE DIFFUSION</p>
    <div class="hero-line"></div>
  </header>

  <nav class="nav-bar">
    <span class="nav-title">ç›®æ¬¡</span>
    <a href="#chapter-1">ç¬¬1ç« </a><a href="#chapter-2">ç¬¬2ç« </a><a href="#chapter-3">ç¬¬3ç« </a>
  </nav>

  <div class="toc">
    <h3>â€” ç›®æ¬¡ â€”</h3>
        <a href="#chapter-1" class="toc-item"><span class="toc-num">1</span><span class="toc-label">æ–°ã—ã„å§‹ã¾ã‚Š</span></a>
        <a href="#chapter-2" class="toc-item"><span class="toc-num">2</span><span class="toc-label">é£Ÿäº‹ä½œã‚Šã«æŒ‘æˆ¦</span></a>
        <a href="#chapter-3" class="toc-item"><span class="toc-num">3</span><span class="toc-label">å®¶æ—ã®ä¸€æ—¥</span></a>
  </div>

  <div class="characters">
    <h3>â€” ç™»å ´äººç‰© â€”</h3>
    <div class="char-grid">
      <div class="char-card">
        <div class="char-name">å°å¤œå­</div>
        <div class="char-role">main</div>
        <div class="char-desc">å®Œç’§ä¸»ç¾©è€…ã§çŒ®èº«çš„ãªæ€§æ ¼ã ãŒã€å®¶æ—ã¸ã®æ„›æƒ…ã¯æ·±ã„</div>
      </div>
      <div class="char-card">
        <div class="char-name">æ‹“ä¹Ÿ</div>
        <div class="char-role">sub</div>
        <div class="char-desc">å…ƒæ°—ã„ã£ã±ã„ã€‚æ¯è¦ªã¸ã®ä¾å­˜å¿ƒãŒé«˜ã„</div>
      </div>
    </div>
  </div>

  <div class="section-divider"></div>

  <main>

    <section class="chapter" id="chapter-1">
      <div class="chapter-header">
        <span class="chapter-number">ç¬¬1ç« </span>
        <h2 class="chapter-title">æ–°ã—ã„å§‹ã¾ã‚Š</h2>
      </div>
      
        <div class="chapter-image">
          <img src="images/chapter_01.png" alt="ç¬¬1ç«  æŒ¿çµµ"
               loading="lazy" />
        </div>
      <div class="chapter-body">
        <p>æœã®è–„æš—ã•ãŒã¾ã é ã–ã‹ã£ã¦ã„ã‚‹ã€‚æ–°ã—ã„ãƒãƒ³ã‚·ãƒ§ãƒ³ã®ä¸€å®¤ã€çª“ã‹ã‚‰è¦‹ãˆã‚‹ã®ã¯é™å¯‚ãªè¡—ã¨å¾®å¦™ã«æºã‚Œã‚‹æœ¨ã€…ã®å½±ã ã‘ã ã£ãŸã€‚é›¨ä¸ŠãŒã‚Šã§ã€é“è·¯ã¯æ¿¡ã‚Œã¦ã„ãŸãŒç©ºã«ã¯é›²ä¸€ã¤ãªã„æ™´ã‚Œæ¸¡ã‚Šã‚ˆã†ã ã€‚æ—¥å…‰ã¯åºŠã‚’æ·¡ãç…§ã‚‰ã—ã€æ´—æ¿¯ç‰©ã®è‰²ã¾ã§å¼•ãç«‹ã¦ã¦ã„ãŸã€‚</p>

        <p>å°å¤œå­ã¯ç›®è¦šã‚ã‚‹ã¨ã™ããƒ™ãƒƒãƒ‰ã‹ã‚‰èµ·ãä¸ŠãŒã£ãŸã€‚å¯ç™–ã‚’ã¤ã‘ãŸé«ªã‚’æ‰‹ãã—ã§æ•´ãˆãªãŒã‚‰çª“éš›ã¸ã¨é€²ã‚€ã€‚ã€Œã¾ã æ—©ã„ã­ã€ã¨ã¤ã¶ã‚„ãã€è»½ã„èº«ä½“ã«æœéœ²ãŒé™ã‚Šã‚‹ã‚ˆã†ãªçˆ½å¿«ãªæ°—åˆ†ã«ãªã‚‹ã€‚</p>

        <p>å½¼å¥³ã¯æ–°ã—ã„ç”Ÿæ´»ãŒå§‹ã¾ã£ãŸã“ã¨ã‚’æ„Ÿã˜ã‚‹ã€‚</p>
        <p>è·è§£ãã®æº–å‚™ã‚’ã—ã¦ã‹ã‚‰éƒ¨å±‹ã®ä¸­ã‚’è¦‹æ¸¡ã™ã€‚å®¶å…·é¡ã‚„è¡£è£…ã‚±ãƒ¼ã‚¹ãªã©ã€å¼•ã£è¶Šã—ã§é›†ã‚ã‚‰ã‚ŒãŸç‰©ã€…ã—ã•ã¨ã€ã¾ã ãã‚Œã‚‰ã‚’é…ç½®ã§ãã¦ã„ãªã„ç©ºè™šã•ãŒã‚ã‚‹ã€‚å£ç´™ã«ã¯æ–°ã—ã„å®¶ã¨ã„ã†åŒ‚ã„ãŒæ¼‚ã£ã¦ã„ã‚‹ã€‚</p>

        <p>ã€Œå§‹ã‚ã‚ˆã†ã€</p>

        <p>å½¼å¥³ã¯ãƒ™ãƒ“ãƒ¼ã‚«ãƒ¼ã®ä¸Šã®æ‹“ä¹Ÿã«ç›®ã‚’å‘ã‘ãŸã€‚</p>
        <p>å°ã•ãªæ¯å­ã¯å¯ã¼ã‘ã¦ã„ã‚‹è¡¨æƒ…ã§å¾®ç¬‘ã‚“ã ã€‚ã€ŒãŠæ¯ã•ã‚“ã€ã¨ã¤ã¶ã‚„ãã¨ã€æ‰‹ã‚’ä¼¸ã°ã™ã‚ˆã†ã«æŒ‡å…ˆã‚’é–‹ãé–‰ã˜ã—ã¦ã„ã‚‹ã€‚å°å¤œå­ã‚‚ç¬‘é¡”ã‚’è¦‹ã›è¿”ã—ã€ã€Œã‚‚ã†ã™ãèµ·ãã‚‹æ™‚é–“ã ã‚ˆã€ã¨å£°ã‚’ã‹ã‘ã‚‹ã€‚</p>

        <p>æ´—æ¿¯æ©Ÿã®éŸ³ãŒé™å¯‚ãªéƒ¨å±‹ã«éŸ¿ãã€‚</p>
        <p>å½¼å¥³ã¯ç´ æ—©ãæº–å‚™ã‚’ã—ã¦æƒé™¤ç”¨å…·ã‚’å–ã‚Šå‡ºã—ãŸã€‚æƒé™¤ã¯å¿ƒåœ°ã‚ˆã„ãƒªã‚ºãƒ ã ã£ãŸã€æ±šã‚Œã¨æˆ¦ã†ã‹ã®ã‚ˆã†ãªæ‰‹ã¤ãã§åºŠã‚„æ£šã‚’æ‹­ãå§‹ã‚ã‚‹ã€‚ã€Œã“ã‚Œãã‚‰ã„ãªã‚‰å¤§ä¸ˆå¤«ã ã€ã¨è‡ªåˆ†è‡ªèº«ã«è¨€ã„èã‹ã›ã‚‹ã€‚</p>

        <p>çª“ã‹ã‚‰ã®å…‰ãŒå¼·ããªã£ã¦ãã‚‹ã«ã¤ã‚Œã¦éƒ¨å±‹ã®æ¸©åº¦ã‚‚ä¸Šæ˜‡ã—ãŸã€‚</p>
        <p>å°å¤œå­ã¯æ±—ã°ã‚€é¡ã‹ã‚‰é«ªã‚’æ‰•ã„ã€å°ã•ãªæ¯å­ã‚’è¦‹ã¤ã‚ãªãŒã‚‰ä¸€æœã™ã‚‹ã€‚ãƒ™ãƒ“ãƒ¼ã‚«ãƒ¼ã«ä¹—ã£ãŸæ‹“ä¹Ÿã¯èµ·ãä¸ŠãŒã‚ã†ã¨æ‰‹è¶³ã‚’å‹•ã‹ã™ã€‚ã€Œã­ãˆã€ã¨å¾®ç¬‘ã‚“ã§è¦‹ã›ã‚‹ã€‚</p>

        <p>ã€ŒãŠæ¯ã•ã‚“ãŒã„ã‚‹ã‚ˆã€</p>

        <p>å°å¤œå­ã®å£°ã«é ·ãã‚ˆã†ã«ã€é™ã‹ãªéƒ¨å±‹ã§æ¯å­ãŒå°ã•ãç¬‘ã†ã€‚</p>
        <p>çª“ã‚¬ãƒ©ã‚¹ã‚’é€šã‚ŠæŠœã‘ã¦ãã‚‹é¢¨ã€‚ãã®å¾®ç´°ãªå‹•ãã¯å°ã•ãªæ³¢ã®ã‚ˆã†ã«å®¤å†…å…¨ä½“ã‚’åŒ…ã¿è¾¼ã‚€ã€‚ã€Œã“ã“ã‹ã‚‰æ–°ã—ã„ç”Ÿæ´»ãŒå§‹ã¾ã‚‹ã­ã€ã¨å½¼å¥³è‡ªèº«ã«ã‚‚èªã‚Šã‹ã‘ã¦ã„ãŸã€‚</p>

        <p>æƒé™¤ã®éŸ³ã ã‘éŸ¿ãã€å…‰ã¨å½±ãŒå¾®å¦™ã«çµ¡ã‚“ã§ã„ãä¸­ã§</p>
        <p>å°å¤œå­ã¯è‡ªåˆ†ã®æ‰‹ã®ä¸­ã§æ–°ãŸãªæ—¥ã€…ã‚’è¦‹ã¤ã‘ã¦ã„ã£ãŸã€‚çª“æ ã«ã¯æ—¥å·®ã—ãŒå…¥ã£ã¦æ¥ã¦ã„ãŸãŒã€ã¾ã ãã‚Œã»ã©å¼·ãã‚‚ãªãã€éƒ¨å±‹å…¨ä½“ã‚’åŒ…ã‚€ç©ã‚„ã‹ã•ãŒã‚ã£ãŸã€‚</p>

        <p>å½¼å¥³ã¯ã“ã®æ—¥ã®æƒé™¤ã‚’çµ‚ãˆã‚‹ã¨ã€ãƒ™ãƒ“ãƒ¼ã‚«ãƒ¼ã®ä¸Šã«æ‹“ä¹Ÿã‚’è¿ãˆã«è¡Œã£ãŸã€‚</p>
        <p>ã€ŒãŠæ¯ã•ã‚“ãŒã„ã‚‹ã‚ˆã€ã¨å£°ã«å‡ºã—ã¦å¾®ç¬‘ã‚“ã ã€‚æ¯å­ã®é«ªã‚’æ’«ã§ã€ã€Œé ‘å¼µã£ãŸã­ã€ã¨å°ã•ãªèº«ä½“ã‹ã‚‰åŠ›ã‚’å€Ÿã‚Šã‚‹ã‚ˆã†ãªä»•è‰ã‚’è¦‹ã›ãŸã€‚</p>

        <p>å°å¤œå­ã¯çª“éš›ã¸ã¨é€²ã¿ã€æ˜ã‹ã‚ŠãŒå…¥ã‚Šè¾¼ã‚€æ–°ã—ã„æ—¥ã€…ã‚’è¦‹æ®ãˆãŸã€‚</p>
        <p>ãã®å…ˆã«ã¯æœªçŸ¥ã ãŒã€å½¼å¥³ã®ä¸­ã§ã¯æ—¢ã«ç­”ãˆãŒã‚ã£ãŸã€‚æƒé™¤ç”¨å…·ã‚’ç‰‡ä»˜ã‘ãªãŒã‚‰ã€ã€Œã¾ãŸæ˜æ—¥ã€ãã†è‡ªåˆ†è‡ªèº«ã«å¯¾ã—ã¦ç´„æŸã‚’ã™ã‚‹ã‚ˆã†ã«å¾®ç¬‘ã‚“ã ã€‚</p>

        <p>å…‰ã¯é™ã‹ã«éƒ¨å±‹ã®éš…ã€…ã¾ã§åºƒãŒã‚‹</p>
        <p>çª“ã‹ã‚‰è¦‹ãˆã‚‹è¡—ã¯æœæ—¥ã¨å…±ã«å‹•ãå§‹ã‚ã¦ã„ãŸã€‚</p>
        <p>ã¾ã æ–°ã—ã„å®¶ã ãŒã€ãã®å…ˆã«ã¯å°å¤œå­ã¨æ‹“ä¹Ÿã¸ã®æš–ã‹ãªæ—¥ã€…ãŒå¾…ã£ã¦ã„ã‚‹ã€‚</p>
      </div>
    </section>
    <section class="chapter" id="chapter-2">
      <div class="chapter-header">
        <span class="chapter-number">ç¬¬2ç« </span>
        <h2 class="chapter-title">é£Ÿäº‹ä½œã‚Šã«æŒ‘æˆ¦</h2>
      </div>
      
        <div class="chapter-image">
          <img src="images/chapter_02.png" alt="ç¬¬2ç«  æŒ¿çµµ"
               loading="lazy" />
        </div>
      <div class="chapter-body">
        <p>æœæ—¥ãŒæ˜‡ã‚‹å‰ã«ã€çª“ã‚¬ãƒ©ã‚¹ã«ã‹ã‹ã‚‹å°ã•ãªé›¨ç²’ã®å…‰ã€‚å°æ‰€ã§ãƒ‘ãƒ³ã‚’å–ã‚Šå‡ºã—ã€ãƒˆãƒ¼ã‚¹ã‚¿ãƒ¼ã«å…¥ã‚Œã‚‹ã¨éŸ³æ¥½ã¨å…±ã«é»„è‰²ã„ç²‰å¡µã®ã‚ˆã†ãªã‚‚ã®ãŒèˆã†ã€‚å†·è”µåº«ã®ä¸­ã‚’è¦‹å›ã™ã¨ã€æ‰‹ä½œã‚Šã®ãŠæƒ£èœãƒ‘ãƒƒã‚¯ãŒãã£ã‚Šè©°ã¾ã£ã¦ã„ãŸã€‚ã€Œä»Šæ—¥ã‚‚é ‘å¼µã‚ã†ã€ã¨å°å¤œå­ã¯è‡ªåˆ†ã«å¾®ç¬‘ã¿ã‹ã‘ã‚‹ã€‚</p>

        <p>æ–°ã—ã„åœ°åŸŸã§ã®æ–™ç†æ•™å®¤ã®æ—¥ã ã£ãŸã€‚é›†åˆå ´æ‰€ã§ã‚ã‚‹ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ¼ã‚»ãƒ³ã‚¿ãƒ¼ã«ã¯æ—¢ã«ã„ãã¤ã‹ã®äººãŸã¡ãŒå‡ºå‹¤ã—ã¦ã„ãŸã€‚æ˜ã‚‹ã„è‰²åˆã„ã‚’ã—ãŸåŒ…ä¸ã¨é‹ãŒä¸¦ã¹ã‚‰ã‚Œã€æ¸©ã‹ã„ãƒ‘ãƒ³ã®ã‚ˆã†ãªåŒ‚ã„ãŒæ¼‚ã£ã¦ã„ãŸã€‚ã€Œã“ã‚“ã«ã¡ã¯ã€ã¨ç¬‘é¡”ã§æŒ¨æ‹¶ã‚’ã™ã‚‹å¥³æ€§ãŸã¡ã¯ã€ãã‚Œãã‚Œè‡ªåˆ†ã®æŒã¡ç‰©ã‚’å–ã‚Šå‡ºã—ã¦æº–å‚™ã‚’ã—ã¦ã„ã‚‹ã€‚</p>

        <p>ã€ŒãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€</p>
        <p>å°å¤œå­ã‚‚ãã£ã¨å£°ã‚’ã‹ã‘ã‚‹ã€‚å½¼å¥³ãŸã¡ã®å‹•ãã‚’è¦‹ã¦çœŸä¼¼ã‚’ã—ã¦ã„ãã€‚</p>
        <p>åŒ…ä¸ã‚’æŒã¡ãªãŒã‚‰è‚‰ã‚’åˆ‡ã‚‹éŸ³ã¨ã€é‡èœãŒè£‚ã‘ã‚‹æ„Ÿè§¦ã€‚ã€Œä»Šæ—¥ã¯ä½•ã‚’ä½œã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã¨ã€éš£ã«åº§ã£ãŸå¥³æ€§ã¸å•ã„ã‹ã‘ã¦ã¿ãŸã€‚</p>

        <p>ã€Œä»Šæ—¥ã‹ã‚‰ã¯ç°¡å˜ãªæ´‹é£Ÿã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€ã¨æ•™å¸«ã¯è¨€è‘‰ã¨å…±ã«ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’è¦‹ã›ã¦ã„ãŸã€‚æš–ã‹ã„ç…§æ˜ã®ä¸‹ã§æ–‡å­—é€šã‚Šè‰²é®®ã‚„ã‹ãªæ–™ç†ãŒä¸¦ã‚“ã§ã„ã‚‹ã€‚</p>
        <p>å°å¤œå­ã¯çœŸå‰£ãªè¡¨æƒ…ã‚’ã—ãªãŒã‚‰æ•™ç§‘æ›¸ã‚’è¦‹ã¤ã‚ã€è…•çµ„ã¿ã‚’ã—ã¦è€ƒãˆè¾¼ã‚€ã€‚ã€Œã¾ãšã¯ææ–™ã‚’æƒãˆã¾ã™ã­ã€</p>
        <p>å½¼å¥³ã¯å†·è”µåº«ã‹ã‚‰å¿…è¦ãªã‚‚ã®ã‚’å–ã‚Šå‡ºã™ã€‚åµã€ç‰›ä¹³ã€å°éº¦ç²‰ã€è‚‰ã€é‡èœâ€¦â€¦å°ã•ãªè¢‹ã®ä¸­ã«ã¯ã€è‰²ã¨ã‚Šã©ã‚Šã®ç´ æãŒè©°ã¾ã£ã¦ã„ãŸã€‚</p>

        <p>æ–™ç†æ•™å®¤ãŒå§‹ã¾ã‚Šã€å…¨å“¡ã§ä¸€ç·’ã«ä½œæ¥­ã‚’ã™ã‚‹ã€‚</p>
        <p>ã€Œã§ã¯ã‚¹ãƒ¼ãƒ—ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€ã¨æ•™å¸«ã€‚ã€Œã¾ãšã¯å…·æã‚’ç‚’ã‚ã¾ã™ã­ã€</p>
        <p>å°å¤œå­ã¯åŒ…ä¸ã‚’æŒã¤æ‰‹ã«åŠ›ã‚’è¾¼ã‚ã‚‹ã€‚é‡èœã‚’ç´°ã‹ãåˆ‡ã‚‹éŸ³ãŒéƒ¨å±‹ä¸­ã«éŸ¿ãæ¸¡ã£ã¦ã„ã‚‹ã€‚é¦™ã‚Šé«˜ã„æ²¹ã¨ç´ æã®ç›¸æ€§ã‚‚è‰¯ã„ã‚ˆã†ã§ã€å°ã•ãªæ³¡ç«‹ã¦å™¨ã®ã‚ˆã†ãªæ°—æ³¡ãŒæ²¸é¨°ã™ã‚‹ã€‚</p>

        <p>ã€Œæ¬¡ã«ãŠè‚‰ã‚’å…¥ã‚Œã¾ã—ã‚‡ã†ã€ã¨å½¼å¥³ãŸã¡ã¯ãã‚Œãã‚Œè‡ªåˆ†ã®ä½œæ¥­ã‚¹ãƒšãƒ¼ã‚¹ã§å‹•ã„ã¦ã„ãã€‚</p>
        <p>æ•™å®¤å…¨ä½“ã«åºƒãŒã‚‹èª¿ç†éŸ³ã®ä¸­ã§ã€ã€Œã‚ã£ã€ã¨å°å¤œå­ã¯é©šã„ãŸå£°ã‚’ä¸Šã’ã‚‹ã€‚åˆ‡ã£ãŸé‡èœã®ä¸€éƒ¨ãŒæ»‘ã£ã¦åºŠã«è½ã¡ã¦ã—ã¾ã£ãŸã€‚ã€Œå¤§ä¸ˆå¤«ã§ã™ã‹ï¼Ÿã€ã¨ã€è¿‘ãã«ã„ãŸå¥³æ€§ãŸã¡ã‚‚å¿ƒé…ãã†ã«ã™ã‚‹ã€‚</p>

        <p>ã€Œãˆãˆã€å¤§ä¸ˆå¤«ã§ã™ã€å½¼å¥³ã¯ã™ãã«çŠ¶æ³ã‚’å–ã‚Šæˆ»ã™ã€‚</p>
        <p>ã‚‚ã†ä¸€åº¦æ‰‹éš›ã‚ˆãä½œæ¥­ã‚’ã™ã‚‹å°å¤œå­ã«ã¯ã€å°ã•ãªæ±—ç²’ãŒé¡ã‹ã‚‰æµã‚Œã¦ã„ãã€‚è‰²ã¨ã‚Šã©ã‚Šã®å…·æã‚’é‹ã«å…¥ã‚Œã‚‹ã¨ã€ãã®ä¸­ã§å…¨ã¦ãŒæ··ã–ã£ã¦æ–°ã—ã„é¢¨å‘³ã‚’ä½œã‚Šå‡ºã—ã¦ã„ãã€‚</p>

        <p>ã€Œä»Šåº¦ã‹ã‚‰ã¯æ°—ã‚’ã¤ã‘ã¾ã—ã‚‡ã†ã­ã€æ•™å¸«ã¯å„ªã—ãå¾®ç¬‘ã‚€ã€‚</p>
        <p>æ•™å®¤ã®ä¸­ã§ã¯çš†ã§ä¸€ã¤ã®æ–™ç†ã‚’ä½œã‚‹éç¨‹ã‚’è¦‹å®ˆã‚‹äººã€…ã®å£°ã¨ç¬‘ã„ãŒäº¤éŒ¯ã—ã¦ã„ãŸã€‚å…‰ãŒéƒ¨å±‹ã‚’åŒ…ã¿è¾¼ã‚€ã‚ˆã†ã«ã€æš–ã‹ã„ç©ºæ°—ãŒæµã‚Œã‚‹ä¸­ã€ã€Œä»Šæ—¥ã¯æ¥½ã—ã‹ã£ãŸã§ã™ã­ã€ã¨å°å¤œå­ã¯å‹é”ã«è©±ã™ã€‚</p>

        <p>çª“ã‹ã‚‰è¦‹ãˆã‚‹å¤–ã«ã¯ã€ã‚‚ã†æ—¥ä¸­ã®é’ã€…ã¨ã—ãŸåºƒå¤§ãªæ™¯è‰²ãŒæ‹¡ãŒã£ã¦ã„ãŸã€‚ã€Œã¾ãŸæ˜æ—¥ã­ã€å½¼å¥³ãŸã¡ã¯æ•™å®¤ã‚’è¦‹å›ã—ã¦åˆ¥ã‚Œã‚’å‘Šã’ã¦ã„ãã€‚</p>
        <p>ã€ŒãŠå¸°ã‚Šãã ã•ã„ã€ã¨æ•™å®¤ã®å‡ºå£ã§å¾®ç¬‘ã‚€æ•™å¸«ã¸ã€ã€Œã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ã€ã¨å°å¤œå­ã¯è¿”ã™ã€‚</p>

        <p>æ–°ãŸãªåœ°åŸŸã§ã®ç”Ÿæ´»ãŒå§‹ã¾ã‚Šã€æ—¥ã€…ã®ä¸­ã§ã‚‚æ§˜ã€…ãªå­¦ã³ãŒã‚ã‚Šã¤ã¤ã‚ã£ãŸã€‚æ–™ç†ã‚’é€šã˜ã¦äººã€…ã¨ã®ã¤ãªãŒã‚Šã‚‚æ·±ã¾ã£ãŸã€‚ã€Œã¾ãŸæ˜æ—¥ã­ã€å½¼å¥³ãŸã¡ã¯åˆ¥ã‚Œã‚’å‘Šã’ãªãŒã‚‰ã€æ–°ã—ã„å­£ç¯€ã®å§‹ã¾ã‚Šã‚’æ„Ÿã˜ã¦ã„ãŸã€‚</p>
        <p>ï¼ˆç¶šãï¼‰</p>
      </div>
    </section>
    <section class="chapter" id="chapter-3">
      <div class="chapter-header">
        <span class="chapter-number">ç¬¬3ç« </span>
        <h2 class="chapter-title">å®¶æ—ã®ä¸€æ—¥</h2>
      </div>
      
        <div class="chapter-image">
          <img src="images/chapter_03.png" alt="ç¬¬3ç«  æŒ¿çµµ"
               loading="lazy" />
        </div>
      <div class="chapter-body">
        <p>é™½å°„ã—ãŒæ˜¥ã®å…¬åœ’ã‚’å„ªã—ãåŒ…ã¿è¾¼ã‚€ã€‚ãƒ™ãƒ³ãƒã«åº§ã‚‹äººã€…ãŒã€æ¸©ã‹ãªå…‰ã®ä¸­ã§å¾®ç¬‘ã‚“ã§ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆãŸã€‚çˆ½ã‚„ã‹ãªé¢¨ãŒå¹ãæŠœã‘ã¦ã„ãã¨ã€é ãã§å­ã©ã‚‚ãŸã¡ã®ç¬‘ã„å£°ãŒèã“ãˆã‚‹ã€‚</p>

        <p>ã€Œãƒãƒã€ã‚ãã¼ã†ã‚ˆã€ã¨æ‹“ä¹Ÿã¯ãƒ™ãƒ“ãƒ¼ã‚«ãƒ¼ã‹ã‚‰æ‰‹ã‚’ä¼¸ã°ã—ãŸã€‚</p>
        <p>å°å¤œå­ã¯ãã®å°ã•ãªæ‰‹ã‚’å–ã‚Šã€ã€Œä»Šã™ãè¡Œãã‚ã­ã€‚ã‚‚ã†å°‘ã—ã ã‘å¾…ã£ã¦ã¦ãã‚Œã‚‹ï¼Ÿã€ã¨è¨€ã£ãŸã€‚</p>

        <p>å…¬åœ’ã®èŠç”Ÿã§ã¯èµ¤ã„èŠ±ã€…ãŒå’²ãèª‡ã‚Šã€ç·‘ã¨è‰²ã¨ã‚Šã©ã‚Šã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãŒã‚ã‚‰ã‚†ã‚‹æ–¹å‘ã‹ã‚‰æ˜¥ã‚’å±Šã‘ã¦ãã‚‹ã€‚å°å¤œå­ã¯æ‹“ä¹Ÿã‚’é€£ã‚Œã¦ç ‚å ´ã¸å‘ã‹ã†ã€‚æ‰‹è¢‹ã‚’ã¤ã‘ãŸå°ã•ãªä¸¡æ‰‹ã§ã—ã£ã‹ã‚Šã¨æ¡ã£ã¦ã¤ã‹ã¿ã€å½¼ã®ç¬‘é¡”ãŒæ™´ã‚Œã‚„ã‹ãªç©ºæ°—ã®ä¸­ã«é£›ã³è¾¼ã‚“ã§ã„ãã€‚</p>

        <p>ã€Œãƒãƒã¨ä¸€ç·’ã«éŠã³ãŸã„ãªã€ã¨æ‹“ä¹Ÿã€‚</p>
        <p>å°å¤œå­ã¯ç¬‘ã„ãªãŒã‚‰ã€ã€Œã‚‚ã¡ã‚ã‚“ã ã‚ˆã€ã¨è¿”ã—ãŸã€‚ã€Œå›ã¨éã”ã™æ™‚é–“ãŒä¸€ç•ªæ¥½ã—ã„ã‹ã‚‰ã€</p>

        <p>å¤«ãƒ»å¥ã¨ã®ä¼šè©±ã‚‚æ¬ ã‹ã•ãªã„ã€‚äºŒäººã§ãƒ™ãƒ³ãƒã«åº§ã‚Šã€ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’é£²ã¿ãªãŒã‚‰æ¯å­ã®æˆé•·ã‚’èªã‚‹ã€‚</p>

        <p>ã€Œå½¼ã®è¨€è‘‰ãŒå¢—ãˆãŸã‚ˆã­ã€</p>
        <p>ã€Œã†ã‚“ã­ãˆã€æ¯æ—¥ãŒæ–°é®®ã ã‚ˆã€ã¨ç­”ãˆãŸã€‚</p>
        <p>é™ã‹ãªå…¬åœ’ã®é›‘éŸ³ã®ä¸­ã§ã€å¤«å©¦ã¯äº’ã„ã¸ã®æ„Ÿè¬ã¨æ„›æƒ…ã‚’ç¢ºèªã™ã‚‹ã€‚å°é³¥ãŸã¡ãŒæã«æ­¢ã¾ã‚Šã€é ãã§å°ã•ãªå­ä¾›ãŸã¡ãŒé£›è¡Œæ©Ÿã‚’ä½œã£ã¦éŠã‚“ã§ã„ã‚‹ã€‚</p>

        <p>ãƒ”ã‚¯ãƒ‹ãƒƒã‚¯ãƒã‚¹ã‚±ãƒƒãƒˆã‚’é–‹ãã€ãŠè“å­ã‚„æœç‰©ã‚’ãŠäº’ã„ã«åˆ†ã‘åˆã†ã€‚ã€Œã“ã‚Œç¾å‘³ã—ã„ã‹ã‚‰ã€ã¨å¥ã¯ã‚¹ãƒ©ã‚¤ã‚¹ã—ãŸãƒªãƒ³ã‚´ã‚’å·®ã—å‡ºã—ãŸã€‚</p>
        <p>ã€Œã‚ã‚ŠãŒã¨ã†ã€</p>

        <p>å…¬åœ’ã®ç«¯ã«ã‚ã‚‹æ± ã§ã¯ã‚«ãƒ¢ãƒ¡ãŒæ°´é¢ã‚’æ»‘ã‚‹ã‚ˆã†ã«é£›ã³äº¤ã£ã¦ã„ã‚‹ã€‚å½¼ã‚‰ã®ç¾½éŸ³ã¨æ°´ã—ã¶ããŒå°å¤œå­ãŸã¡ã®ä¼šè©±ã‚’å½©ã‚‹ã€‚</p>

        <p>æ‹“ä¹Ÿã¯ç ‚å ´ã§ã‚­ãƒ£ã‚¿ãƒ”ãƒ©ãƒ¼ã‚’ä½œã‚Šå§‹ã‚ã€ãã®å‚ã‚‰ã§ãŠçˆ¶ã•ã‚“ãŠæ¯ã•ã‚“ã®è©±ã«è€³ã‚’å‚¾ã‘ã¦ã„ã‚‹ã€‚ã€Œãƒ‘ãƒ‘ãƒãƒå¤§å¥½ãã€ã¨å½¼ã¯å°ã•ãªå£°ã§è¨€ã£ãŸã€‚</p>
        <p>å°å¤œå­ã¯å¤«ã‚’è¦‹ã¤ã‚ã€ã€Œã“ã“ã§ã®æ™‚é–“ãŒä½•ã‚ˆã‚Šã‚‚å¤§åˆ‡ã ã‚ã€ã¨å¾®è‹¦ç¬‘ã—ãªãŒã‚‰å›ã„ãŸã€‚</p>

        <p>å¤•æš®ã‚ŒãŒå…¬åœ’ã®å…‰æ™¯ã‚’ç©ã‚„ã‹ã«æŸ“ã‚ã¦ã„ãã€‚å®¶æ—ä¸‰äººæƒã£ã¦å®¶è·¯ã«ã¤ãæº–å‚™ã‚’ã—ã¦ã„ã‚‹ã€‚ã€Œãƒãƒã€ã¾ãŸæ˜æ—¥ã­ã€</p>
        <p>ã€Œã†ã‚“ã€ãŠã‚„ã™ã¿ãªã•ã„ã€</p>

        <p>ãã®è¨€è‘‰ã¨å…±ã«å°å¤œå­ã¯æ‹“ä¹Ÿã¨å¥ã¨ä¸€ç·’ã«æ­©ã¿å‡ºã™ã€‚é ãã§é³´ã‚ŠéŸ¿ãå¤•ã¹ã®é™å¯‚ãŒå…¬åœ’ã‚’åŒ…ã‚“ã§ã„ãŸã€‚</p>

        <p>æ˜¥é¢¨ã«å¹ã‹ã‚Œã¦ã„ãå½¼å¥³ã®é•·ã„é»’é«ªã¯ã€å…‰ã®ä¸­ã§è¼ããªãŒã‚‰æºã‚Œå‹•ã„ã¦ã„ã£ãŸã€‚</p>
        <p>ã€Œä»Šæ—¥ã‚‚ä¸€æ—¥ã€ã‚ã‚ŠãŒã¨ã†ã€ã¨ã„ã†è¨€è‘‰ã ã‘ã§ã¯ãªãã€ãã®æ—¥ã®çµ‚ã‚ã‚Šã«ã¯å®¶æ—ã¸ã®æ„Ÿè¬ã¨æ„›æƒ…ãŒã‚ã‚‰ã‚ã«ãªã£ãŸã€‚</p>
      </div>
    </section>
  </main>

  <footer class="footer">
    <p>å®Œç’§ãƒãƒã®æ—¥ã€…å¥®é—˜è¨˜</p>
    <p>Generated locally with Ollama + Stable Diffusion</p>
  </footer>


  <button class="tts-fab" id="ttsFab" onclick="ttsToggle()" title="Read aloud">
    <span id="ttsFabIcon">&#x1f50a;</span>
  </button>
  <div class="tts-bar" id="ttsBar">
    <button onclick="ttsPause()" id="ttsPauseBtn">&#x23f8;</button>
    <button onclick="ttsStop()">&#x23f9;</button>
    <button onclick="ttsPrev()">&#x23ee;</button>
    <button onclick="ttsNext()">&#x23ed;</button>
    <span class="tts-info" id="ttsInfo">Ready</span>
    <span class="tts-speed">
      <input type="range" id="ttsSpeed" min="0.5" max="2.0" step="0.1"
             value="1.0" onchange="ttsSetSpeed(this.value)" />
      <span id="ttsSpeedVal">1.0x</span>
    </span>
  </div>

  <button class="mode-toggle" onclick="toggleMode()">ğŸŒ— è¡¨ç¤ºåˆ‡æ›¿</button>

  <script>
    // Reading mode
    function toggleMode() {
      document.body.classList.toggle('light');
      localStorage.setItem('mode', document.body.classList.contains('light') ? 'light' : 'dark');
    }
    if (localStorage.getItem('mode') === 'light') document.body.classList.add('light');

    // Scroll progress
    window.addEventListener('scroll', () => {
      const h = document.documentElement;
      const pct = (h.scrollTop / (h.scrollHeight - h.clientHeight)) * 100;
      document.getElementById('progress').style.width = pct + '%';
    });

    // === TTS (Web Speech API) ===
    const synth = window.speechSynthesis;
    let ttsChs = [], ttsI = 0, ttsRate = 1.0, ttsOn = false, ttsPd = false;

    document.querySelectorAll('.chapter').forEach((sec, i) => {
      const b = sec.querySelector('.chapter-body');
      const t = sec.querySelector('.chapter-title');
      if (b) ttsChs.push({
        title: t ? t.textContent : ('Ch.' + (i+1)),
        text: b.textContent.trim(), el: sec
      });
    });

    function ttsToggle() {
      if (!synth) { alert('Speech not supported'); return; }
      if (ttsOn) { ttsStop(); return; }
      const sy = window.scrollY + window.innerHeight / 3;
      let cl = 0;
      ttsChs.forEach((c, i) => { if (c.el.offsetTop <= sy) cl = i; });
      ttsI = cl; ttsOn = true; ttsPd = false;
      document.getElementById('ttsFab').classList.add('speaking');
      document.getElementById('ttsFabIcon').innerHTML = '&#x23f9;';
      document.getElementById('ttsBar').classList.add('active');
      _ttsRead();
    }

    function _ttsRead() {
      if (ttsI >= ttsChs.length) { ttsStop(); return; }
      synth.cancel();
      const ch = ttsChs[ttsI];
      document.getElementById('ttsInfo').textContent = ch.title;
      ch.el.scrollIntoView({ behavior: 'smooth', block: 'start' });

      // Split by Japanese sentence endings for reliable playback
      const sents = ch.text.match(/[^ã€‚ï¼ï¼Ÿ
]+[ã€‚ï¼ï¼Ÿ]?/g) || [ch.text];
      let si = 0;

      function next() {
        if (!ttsOn) return;
        if (si >= sents.length) {
          ttsI++;
          if (ttsI < ttsChs.length) setTimeout(_ttsRead, 800);
          else ttsStop();
          return;
        }
        const u = new SpeechSynthesisUtterance(sents[si].trim());
        u.lang = 'ja-JP'; u.rate = ttsRate;
        const vs = synth.getVoices();
        const jv = vs.find(v => v.lang && v.lang.startsWith('ja'));
        if (jv) u.voice = jv;
        u.onend = () => { si++; next(); };
        u.onerror = () => { si++; next(); };
        synth.speak(u);
      }
      next();
    }

    function ttsPause() {
      if (!ttsOn) return;
      if (ttsPd) {
        synth.resume(); ttsPd = false;
        document.getElementById('ttsPauseBtn').innerHTML = '&#x23f8;';
      } else {
        synth.pause(); ttsPd = true;
        document.getElementById('ttsPauseBtn').innerHTML = '&#x25b6;';
      }
    }

    function ttsStop() {
      synth.cancel(); ttsOn = false; ttsPd = false;
      document.getElementById('ttsFab').classList.remove('speaking');
      document.getElementById('ttsFabIcon').innerHTML = '&#x1f50a;';
      document.getElementById('ttsBar').classList.remove('active');
      document.getElementById('ttsInfo').textContent = 'Ready';
      document.getElementById('ttsPauseBtn').innerHTML = '&#x23f8;';
    }

    function ttsNext() { if (ttsOn && ttsI < ttsChs.length - 1) { ttsI++; _ttsRead(); } }
    function ttsPrev() { if (ttsOn && ttsI > 0) { ttsI--; _ttsRead(); } }
    function ttsSetSpeed(v) {
      ttsRate = parseFloat(v);
      document.getElementById('ttsSpeedVal').textContent = v + 'x';
    }
    if (synth) synth.onvoiceschanged = () => synth.getVoices();

  </script>
</body>
</html>